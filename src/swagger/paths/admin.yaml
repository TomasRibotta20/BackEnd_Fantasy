/admin/config:
  get:
    summary: Obtiene la configuración actual del sistema (solo administrador)
    description: Recupera toda la configuración del juego incluyendo jornada activa, límites y parámetros de cláusulas.
    tags: [Admin]
    responses:
      200:
        description: Configuración recuperada exitosamente.
        content:
          application/json:
            schema:
              type: object
              properties:
                success:
                  type: boolean
                  example: true
                data:
                  $ref: '#/components/schemas/GameConfig'
      404:
        description: No hay configuración establecida.
      500:
        description: Error del servidor.
  patch:
    summary: Actualiza la configuración del sistema (solo administrador)
    description: Permite actualizar múltiples campos de configuración del juego. Se pueden actualizar uno o varios parámetros en una sola petición.
    tags: [Admin]
    requestBody:
      required: true
      content:
        application/json:
          schema:
            type: object
            properties:
              jornadaId:
                type: integer
                example: 11
                description: ID de la jornada a establecer como activa
              modificacionesHabilitadas:
                type: boolean
                example: false
                description: Habilitar/deshabilitar modificaciones de equipos por parte de los usuarios
              cupoMaximoTorneos:
                type: integer
                minimum: 1
                maximum: 10
                example: 5
                description: Máximo de torneos en los que un usuario puede participar simultáneamente
              dias_proteccion_clausula:
                type: integer
                minimum: 0
                maximum: 14
                example: 2
                description: Días de protección después de fichar un jugador
              ratio_blindaje_clausula:
                type: number
                minimum: 1
                maximum: 5
                example: 2
                description: Ratio de conversión para calcular costo de blindaje
              max_jugadores_por_equipo:
                type: integer
                minimum: 11
                maximum: 25
                example: 15
                description: Cantidad máxima de jugadores permitidos por equipo
    responses:
      200:
        description: Configuración actualizada exitosamente.
        content:
          application/json:
            schema:
              type: object
              properties:
                success:
                  type: boolean
                  example: true
                message:
                  type: string
                  example: 'Configuración actualizada exitosamente'
                data:
                  type: object
                  properties:
                    id:
                      type: integer
                      example: 1
                    jornada_activa:
                      type: object
                      nullable: true
                      properties:
                        id:
                          type: integer
                          example: 11
                        nombre:
                          type: string
                          example: 'Fecha 11'
                    modificaciones_habilitadas:
                      type: boolean
                      example: false
                    cupo_maximo_torneos:
                      type: integer
                      example: 5
                    dias_proteccion_clausula:
                      type: integer
                      example: 2
                    ratio_blindaje_clausula:
                      type: number
                      example: 2
                    max_jugadores_por_equipo:
                      type: integer
                      example: 15
                    updatedAt:
                      type: string
                      format: date-time
                      example: '2026-01-13T10:30:00Z'
      400:
        description: Datos de entrada inválidos o fuera de rango.
        content:
          application/json:
            schema:
              type: object
              properties:
                message:
                  type: string
                  examples:
                    cupo_bajo:
                      value: 'El cupo máximo debe ser al menos 1'
                    cupo_alto:
                      value: 'El cupo máximo no puede exceder 10 participantes'
                    dias_rango:
                      value: 'Los días de protección deben estar entre 0 y 14'
                    ratio_rango:
                      value: 'El ratio de blindaje debe estar entre 1 y 5'
                    jugadores_bajo:
                      value: 'El máximo de jugadores por equipo debe ser al menos 11'
                    jugadores_alto:
                      value: 'El máximo de jugadores por equipo no puede exceder 25'
      404:
        description: Jornada especificada no encontrada.
      500:
        description: Error del servidor.

/admin/jornadas/{jornadaId}/procesar:
  post:
    summary: Procesa completamente una jornada (solo administrador)
    description: |
      Ejecuta el proceso completo de cierre de jornada dentro de una transacción. Los pasos incluyen:
      1. Verificar que las modificaciones estén deshabilitadas
      2. Crear snapshots de todos los equipos
      3. Obtener estadísticas de la API externa
      4. Calcular puntajes de todos los equipos
      5. Actualizar precios de jugadores según rendimiento
      6. Generar recompensas para los mejores equipos
      7. Opcionalmente activar la siguiente jornada

      Si cualquier paso falla, toda la transacción se revierte.
    tags: [Admin]
    parameters:
      - in: path
        name: jornadaId
        required: true
        schema:
          type: integer
        description: ID de la jornada a procesar
        example: 10
    requestBody:
      required: false
      content:
        application/json:
          schema:
            type: object
            properties:
              activarJornada:
                type: boolean
                default: true
                example: true
                description: Si true, activa automáticamente la siguiente jornada después de procesar
    responses:
      200:
        description: Jornada procesada exitosamente.
        content:
          application/json:
            schema:
              type: object
              properties:
                success:
                  type: boolean
                  example: true
                message:
                  type: string
                  example: 'Jornada Fecha 10 procesada exitosamente'
                data:
                  type: object
                  properties:
                    jornadaNombre:
                      type: string
                      example: 'Fecha 10'
                    snapshotsCreados:
                      type: boolean
                      example: true
                      description: Indica si se crearon snapshots de equipos
                    puntajesCalculados:
                      type: boolean
                      example: true
                      description: Indica si se calcularon los puntajes
                    preciosActualizados:
                      type: integer
                      example: 180
                      description: Cantidad de precios de jugadores actualizados
                    jornadaActivada:
                      type: boolean
                      example: true
                      description: Indica si se activó la siguiente jornada
                    mensaje:
                      type: string
                      example: 'Jornada "Fecha 11" activada'
                      description: Mensaje adicional sobre la activación de jornada
      400:
        description: Error de validación.
        content:
          application/json:
            schema:
              type: object
              properties:
                message:
                  type: string
                  example: 'Debes deshabilitar las modificaciones antes de procesar la jornada'
      404:
        description: Jornada no encontrada.
      500:
        description: Error del servidor. La transacción se revierte automáticamente.

/admin/jornadas/{jornadaId}/recalcular:
  post:
    summary: Recalcula los puntajes de una jornada ya procesada (solo administrador)
    description: Vuelve a calcular los puntajes de todos los equipos para una jornada específica utilizando los snapshots existentes y las estadísticas actuales. Útil cuando se corrigen datos de estadísticas o se detectan errores en el cálculo inicial.
    tags: [Admin]
    parameters:
      - in: path
        name: jornadaId
        required: true
        schema:
          type: integer
        description: ID de la jornada cuyos puntajes se recalcularán
        example: 10
    responses:
      200:
        description: Puntajes recalculados exitosamente.
        content:
          application/json:
            schema:
              type: object
              properties:
                success:
                  type: boolean
                  example: true
                message:
                  type: string
                  example: 'Puntajes de jornada "Fecha 10" recalculados exitosamente'
                data:
                  type: object
                  properties:
                    jornadaId:
                      type: integer
                      example: 10
                    jornadaNombre:
                      type: string
                      example: 'Fecha 10'
                    equiposActualizados:
                      type: integer
                      example: 50
                      description: Cantidad de equipos cuyos puntajes fueron actualizados
      400:
        description: No hay snapshots para recalcular.
        content:
          application/json:
            schema:
              type: object
              properties:
                message:
                  type: string
                  example: 'No hay snapshots para esta jornada. Debes procesarla primero.'
      404:
        description: Jornada no encontrada.
      500:
        description: Error del servidor.
